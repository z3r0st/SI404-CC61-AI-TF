<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="assets/styles.css" />
    <link rel="shortcut icon" href="#" />
    <title>Asistente de decisiones</title>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@3.6.0/dist/tf.min.js"></script>
  </head>
  <body>
    <main>
      <div class="main">
        <div class="introduction">
          <div class="introduction__title">
            <h1>
              Bienvenido al asistente de decisiones basado en Lógica
              Proposicional
            </h1>
            <h4>
              Esta aplicación usa un modelo de Machine Learning que ha sido
              entrenado para <b>aprender</b> la tabla de verdad de cada uno de
              los principales conectores de la Lógica Proposicional.
            </h4>
          </div>
          <div class="introduction__overview">
            <h2>¿ El propósito ?</h2>
            <div class="introduction__overview__list">
              <ol>
                <li>
                  Proveer de una aplicación interactiva que permita ayudar a
                  tomar decisiones simples del día a día.
                </li>
                <li>
                  Facilitar y hacer más didáctico el aprendizaje de la lógica
                  proposicional mediante una aplicación que la implementa de
                  forma intuitiva con un enfoque netamente aplicativo.
                </li>
                <li>
                  Entretener, así es, también puedes usar la aplicación en algún
                  momento de aburrimiento, solo para pasar el rato.
                </li>
              </ol>
            </div>
          </div>
          <div class="introduction__instructions">
            <h2>¿ En qúe consiste ?</h2>
            <h4>
              Para explicar el funcionamiento, nada mejor que una lista de
              instrucciones:
            </h4>
            <div class="introduction__instructions__list">
              <ol>
                <li>Ingresa un primer enunciado [A], e.g. <i>Hace frío</i>.</li>
                <li>
                  Ingresa un segundo enunciado [B], e.g. <i>Ir a la playa</i>.
                </li>
                <li>
                  Indica mediante el switch de activación respectivo si cada
                  enunciado es verdadero o falso <br />
                  <b>Tip:</b> Solo presiona el switch si el enunciado es falso
                  (Por <i>default</i> es verdadero).
                </li>
                <li>
                  Revisa la lista de conectores de Lógica Proposicional y su
                  descripción.
                </li>
                <li>
                  Elige el conector [~] que mejor describa la relación entre los
                  dos enunciados ingresados.
                </li>
                <li>Haz click en el botón "Validar decisión".</li>
                <li>
                  Recibe como respuesta si la decisión es buena (el resultado de
                  A ~ B es verdadero).
                </li>
              </ol>
              <h4>
                Puedes repetir el proceso cuantas veces sea necesario, hasta
                encontrar una combinación satisfactoria que sea recomendada por
                la aplicación.
              </h4>
            </div>
          </div>
        </div>
        <div class="input">
          <h1>Asistente de Decisiones</h1>
          <div>
            <div class="input__statements">
              <h3>
                <b>I. Ingresa los enunciados</b>
              </h3>
              Desactiva la caja de check si es falso.
              <div class="input__statements__1">
                <label htmlFor="statement-1">
                  Ingresa el primer enunciado [A] :
                </label>
                <input
                  type="text"
                  class="input__statements__text"
                  id="statement-1"
                  width="100"
                />
                <input
                  type="checkbox"
                  class="input__statements__truth"
                  id="statement-1-truth"
                  checked
                />
                <label
                  htmlFor="statement-1-truth"
                  class="input__statements__toggle"
                ></label>
              </div>
              <div class="input__statements__1">
                <label htmlFor="statement-2">
                  Ingresa el primer enunciado [B] :
                </label>
                <input
                  type="text"
                  class="input__statements__text"
                  id="statement-2"
                  width="100"
                />
                <input
                  type="checkbox"
                  class="input__statements__truth"
                  id="statement-2-truth"
                  checked
                />
                <label
                  htmlFor="statement-2-truth"
                  class="input__statements__toggle"
                ></label>
              </div>
            </div>
            <div class="input__operator">
              <h3>
                <b>II. Escoge el conector</b>
              </h3>
              <div class="input__operator__select">
                <div class="input__operator__select__options">
                  <label
                    htmlFor="conjunction"
                    class="input__operator__select__option"
                  >
                    <b>Conector de conjunción:</b>
                    <i>¿ Ambos enunciados son igual de importantes ?</i>
                    <input
                      type="radio"
                      name="operator"
                      id="conjunction"
                      value="0"
                      checked
                    />
                    <span class="checkmark">&lt; &gt;</span>
                  </label>
                </div>
                <div class="input__operator__select__options">
                  <label
                    htmlFor="disjunction"
                    class="input__operator__select__option"
                  >
                    <b>Conector de disjunción:</b>
                    <i
                      >¿ Estarías satisfecho con lograr cualquiera de los
                      dos?</i
                    >
                    <input
                      type="radio"
                      name="operator"
                      id="disjunction"
                      value="0.25"
                    />
                    <span class="checkmark">&lt; &gt;</span>
                  </label>
                </div>
                <div class="input__operator__select__options">
                  <label
                    htmlFor="implication"
                    class="input__operator__select__option"
                  >
                    <b>Conector de implicación:</b>
                    <i>¿ Tiene que suceder B para que pueda darse A ?</i>
                    <input
                      type="radio"
                      name="operator"
                      id="implication"
                      value="0.50"
                    />
                    <span class="checkmark">&lt; &gt;</span>
                  </label>
                </div>
                <div class="input__operator__select__options">
                  <label
                    htmlFor="replication"
                    class="input__operator__select__option"
                  >
                    <b>Conector de replicación:</b>
                    <i>¿ Tiene que suceder A para que pueda darse B ?</i>
                    <input
                      type="radio"
                      name="operator"
                      id="replication"
                      value="0.75"
                    />
                    <span class="checkmark">&lt; &gt;</span>
                  </label>
                </div>
                <div class="input__operator__select__options">
                  <label
                    htmlFor="biconditional"
                    class="input__operator__select__option"
                  >
                    <b>Conector bicondicional:</b>
                    <i>¿ A y B solo servirán si se realizan ambos ?</i>
                    <input
                      type="radio"
                      name="operator"
                      id="biconditional"
                      value="1"
                    />
                    <span class="checkmark">&lt; &gt;</span>
                  </label>
                </div>
              </div>
            </div>
            <button class="input__btn" onclick="validateDecision();">
              &lt;- Validar decisión -&gt;
            </button>
          </div>
        </div>
        <div class="output">
          <h3 class="ouput__preface">
            <span class="output__value" id="output">
              Haz click en "Validar decisión" para obtener un resultado
            </span>
          </h3>
        </div>
      </div>
    </main>
    <script type="text/javascript">
      var model = null;
      (async () => {
        model = await tf.loadLayersModel("./model.json");
      })();

      function validateDecision() {
        let a = document.getElementById("statement-1").value;
        let b = document.getElementById("statement-2").value;

        if (a == "" && b == "") {
          document.getElementById("output").innerHTML =
            "Primero debes ingresar dos enunciados";
          return;
        }

        b = b[0].toLowerCase() + b.slice(1);

        let aTruth = document.getElementById("statement-1-truth").checked
          ? 1
          : 0;
        console.log("A = " + aTruth);
        let bTruth = document.getElementById("statement-2-truth").checked
          ? 1
          : 0;
        console.log("B = " + bTruth);
        let operator = document.querySelector(
          'input[name="operator"]:checked'
        ).value;
        console.log("Operator = " + operator);

        let data = tf.tensor2d([[aTruth, bTruth, operator]]);
        let prediction = model.predict(data).dataSync();
        let result = Math.round(prediction[0], 1) == 1;
        [aTruth, bTruth] = [aTruth == 1, bTruth == 1];
        console.log(aTruth, bTruth, a, b);
        document.getElementById("output").innerHTML = result
          ? `Buena decisión :)<br/> ${
              "<b>" +
              (aTruth ? "" : "No ") +
              a +
              (b[0].toLowerCase() === "i" && bTruth
                ? "</b> e <b>"
                : "</b> y <b>") +
              (bTruth ? "" : "no ") +
              b +
              "</b> es una buena combinación."
            }`
          : `Mala decisión :(<br/> ${
              "<b>" +
              (aTruth ? "" : "No ") +
              a +
              (b[0].toLowerCase() === "i" && bTruth
                ? "</b> e <b>"
                : "</b> y <b>") +
              (bTruth ? "" : "no ") +
              b +
              "</b> no es una buena combinación."
            }`;
        console.log(result);
      }
    </script>
  </body>
</html>
